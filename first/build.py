import meta.Meta as Meta
import numpy as np
from mpl_toolkits import mplot3d
import matplotlib.pyplot as plt
from matplotlib import cm
from matplotlib.colors import LightSource


# adx = [0.7995714468321611, 0.7362934160841978, 0.7359604353035042]
# ady = [-0.8510388498561854, -0.860313032509152, -0.857941773525763]
# adz = [-1.38496656285479, -1.40011549289301, -1.40014194010902]

adx = [0.43845549029804587, -0.664454981894871, -0.9857535388592102, -1.4166126342589487, -1.1114045216596056, -0.03210292577731466, 0.42356804101414036, -0.6776562773186675, -1.0806705225347384, -0.3669506211683009, 0.06591934784007902, -0.37045144520027096, -0.0894951873521449, 0.6771542144743733, 0.8735450202905541, -0.007766783000725308, 0.022659705355060074, -0.3337498062715484, -0.6612471550957957, -2.0901489909028363, -1.843555593866403, 0.35338092722561276, -0.00558494390915637, 0.6823826510111686, 1.0585645634703236, -0.33571911833912327, -1.3459800096158177, -1.75345749573327, -0.6791181535401953, -1.0684244977572253, -0.7499345126009229, 1.0153104516017823, 1.3272412480263864, 1.7621514329784207, 0.9912539565500119, 1.4264262589435102, 0.3728302813786206, -0.0345455352632848, 0.3077951743590274, 0.7238833768158497, 0.39335232496259537, -0.03598954385208125, 0.29767706645531533, 0.7244327920304994, 0.3954138030950697, -0.03564051168573229, 0.30507224885830003, 0.7207930912752936, 0.36876424768815297, -0.6563399331025981, -0.9885317987447773, -1.4225388832414618, -0.3802134359725766, 0.3626710673593916, 0.004184192698075406, -1.0204468874226138, -1.4546324376737683, -0.35773206427746485, 0.021501627049846705, -0.3438772996949832, -0.3760178460380147, -0.007559326295009383, 0.2566214501283535, 0.6955196300721004, 0.6729153116157093, 1.0401457409639125, 1.0564366002369248, 0.3492492752706652, 0.28118478280530734, 0.6934660804383769, 0.6984194106505293, 0.34830353065022995, 0.3248080657370242, 0.691796225970287, 0.7934412252241494, -0.34073779946306026, -0.3880405390119368, -0.00422584813431337, 0.06505263082239607, -1.3959405559486666, -1.3770465304148762, -1.7258030897071173, -1.7950192908959763, 0.3532655136319438, 0.29721507107591943, 0.693866883451672, 0.6927520720616478, 0.6938231615008084]
ady = [1.0842057920770463, 0.307076153221996, 0.7293553276794897, 0.39211898137297696, -0.04788922569900539, 0.7465579295010398, 0.04343640733483756, -0.7218907038718525, -0.02192170743178956, 0.3801141525524275, -0.31368574318160886, -0.5751170837722769, -1.0714796995691747, -0.659454658978903, -1.0396080683158948, -1.2639580292004735, -1.3829971342563916, -1.4569827217907814, 0.005339771412611549, -0.24888320099511257, -1.7444885207806582, -1.413311643498238, -0.003011901143312734, 0.3684426428916652, -0.33766412315454697, -1.0603412807176928, 0.7131091592215886, 0.49202838061304716, -1.3778615533811474, -1.6354303039560472, -2.112576324717724, -1.0049631140666815, -1.4236821938315976, -1.0797486452594636, -0.029588896063880155, 0.2729616175745602, 1.7547975769294257, 1.4292752632123498, 1.0096845659479, 1.3419896813333012, 1.7678390930172247, 1.4337853938398377, 1.002852370858899, 1.3399347571287796, 1.769299401409241, 1.431597144477238, 1.0056621591248718, 1.3541506759788533, 1.7506690917917271, 0.9835140998196387, 1.4199910306470453, 1.0935747546352763, -0.3718792600492311, 0.1982604942797499, 0.6955149905784143, 0.28684818905436876, 1.3646780247733066, 1.7768206837101201, 0.3493620006519458, 0.3068928046086955, 0.6888339908173425, 0.7541282513442682, -1.0450200534409173, -1.010109365734006, -1.3884843039481107, -1.3736321712517638, -1.7336827212820103, -1.7723616352090468, -0.6981634840813555, -0.662700328859152, -1.0410639833891433, -1.0178287483303383, -1.3858559957945382, -1.4164588057003444, -0.0044557605730439764, 0.08038184816647835, -0.3444532337092006, -0.3693486578637967, -0.008672062802710101, 0.2375067538551159, 0.3488159674716792, 0.28459271983739876, 0.6863882885391461, 0.9793481256011992, 1.3850379870707947, 1.4091242619548472, 0.34656653120681535, 0.34691787183715883]
adz = [0.619745630254225, -1.01374676369599, 0.209243964684252, 0.512433195622695, 0.183342738818420, -0.922805771341388, -0.756051705839406, -0.862441628446483, -0.578738425984785, -1.51734342318800, -1.07609577319122, 0.141145770352444, 0.290192310740712, -0.803429008010249, 1.85305701314404, 1.33217653432112, 0.0236044001144613, 0.812079860573583, -1.34568973677862, 3.66398757276737, 5.63805261804615, 0.172058553026981, -1.99344172105938, -1.29848060462322, -0.723578989958229, -0.706393224370477, 0.738701712288790, 3.17022394350480, 0.472057936804732, 3.28448340852794, 3.48258674608253, 0.476368447059018, 2.58525153804202, 2.48332542024307, -0.412441542941486, 1.05343103238881, 1.32290764206679, 0.402612256264605, -0.402888924493066, 0.870891681799516, 1.66220486157916, 0.479170118079331, -0.205498922717243, 0.901672856821299, 1.70669369666770, 0.445085309459259, -0.331377215370554, 0.709120424823262, 1.26764956790430, 0.256070076557979, 1.59102577769160, 1.65796458061194, -1.48091471898550, 0.110846880427624, -1.51229748406739, -0.198458328806081, 2.63859847135372, 1.45360714157301, -1.80350407204393, -1.50865271014713, -1.25475806226449, -0.955596310912379, 0.251757502768246, -0.280144017292879, 0.491744914977337, 1.05864453030564, 2.15740414554992, 1.37931039177719, -0.775401867958444, -0.879837390288856, -0.422294341590195, -0.706109726475214, 0.137415091000475, 0.556780925612804, -0.222946677161729, -0.989827916754984, -1.49117808867642, -1.79476358452446, -1.37281374347870, 1.42854194241042, 0.0771703952010551, 1.72165591465028, 2.08951044017826, -0.255659205696425, 0.431837161411022, 0.496703185839832, -1.39428974476398, -1.39450428457679]

X, Y = np.meshgrid(Meta.x, Meta.y)
Z = Meta.fn(X, Y)
 
fig = plt.figure()
ax = plt.axes(projection ='3d')
ls = LightSource(270, 45)
rgb = ls.shade(Z, cmap=cm.gist_earth, vert_exag=0.1, blend_mode='soft')
ax.plot_surface(X, Y, Z, rstride=1, cstride=1, facecolors=rgb,
                        alpha=0.15,
                       linewidth=0, antialiased=False, shade=False)

for i in range(len(adx) - 1):
    x = adx[i]
    xN = adx[i+1]
    y = ady[i]
    yN = ady[i+1]
    ax.plot3D([x, xN], [y, yN], [Meta.fn(x, y), Meta.fn(xN, yN)], 'red')

plt.show()
